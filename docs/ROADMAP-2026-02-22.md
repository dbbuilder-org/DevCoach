# DevCoach — Consolidated Roadmap

**Date:** 2026-02-22
**Author:** Chris Therriault <chris@servicevision.net>
**Status:** Reconciled from SESSION_CONTEXT_2026-02-21.md + 14 commits

---

## Document Reconciliation

| Document | Status |
|----------|--------|
| `docs/SESSION_CONTEXT_2026-02-21.md` | Superseded by this document |

---

## Current State

### Health Scorecard

| Area | Score | Notes |
|------|-------|-------|
| Architecture | 9/10 | FastAPI + React + PostgreSQL, clean separation |
| Security | 8/10 | Fernet PAT encryption, PAT never logged, rate limiting |
| Test Coverage | 5/10 | 36 scoring tests; journal/coaching/puzzle tests missing |
| Deployment | 8/10 | Render blueprint ready; web + backend live |
| UI/UX | 8/10 | Split-panel dashboard, responsive portrait mode, multi-repo |

### What's Complete

- [x] **Phase 1** — FastAPI skeleton, 7-table PostgreSQL schema, VS Code extension + React webview (commit `9ff9960`, 2026-02-21)
- [x] **Phase 2** — GitHub queue, work block lifecycle, Pomodoro timer, journal read/write, Haiku chat (commit `9ff9960`, 2026-02-21)
- [x] **Phase 3** — Coaching profiles (Peter/Ransom), proactive triggers, context injection, repo hygiene panel (commit `9ff9960`, 2026-02-21)
- [x] **Phase 4** — Puzzle engine, badge system, weekly GitHub Gist streak, ChartsPanel with phase balance (commit `9ff9960`, 2026-02-21)
- [x] **Phase 5** — Fernet PAT encryption, rate limiting, global error handler, render.yaml, .vsix packaging (commit `9ff9960`, 2026-02-21)
- [x] **Setup tooling** — setup.sh + updated README with automated local setup (commit `ea8c6b7`, 2026-02-21)
- [x] **Render deploy** — PostgreSQL URL auto-rewrite, Python 3.12 pin, pydantic 2.10.6, Alembic configparser fix (commits `cea105e`–`17f5b85`, 2026-02-21)
- [x] **Standalone web app** — Vite + React app reusing extension components via `@ext` alias; ConfigScreen with localStorage (commit `a6a5377`, 2026-02-22)
- [x] **Render static site** — `devcoach-web` static service in render.yaml; CORS env var corrected to `FRONTEND_ORIGINS` (commit `0b8b721`, 2026-02-22)
- [x] **Render build fixes** — Extension node_modules installed during web build; removed `strict: true` from web tsconfig (commit `8a1dd23`, 2026-02-22)
- [x] **Credential auto-seed** — `VITE_PREFILL_*` env vars bake PAT + Anthropic key into web build on Render (commit `5f52b20`, 2026-02-22)
- [x] **Start My Day fix** — ApiClient init moved from `useRef + useEffect` to `useMemo` to fix null ref at first render (commit `960fc15`, 2026-02-22)
- [x] **Split-panel dashboard** — react-resizable-panels v4, drag-to-reorder, puzzle overlay on launch, chat full-height (commit `c046704`, 2026-02-22)
- [x] **Multi-repo support** — RepoPicker dropdown in header; Queue/Chat/Today scoped to selected repo; Velocity cross-repo; localStorage persistence (commit `a20eb02`, 2026-02-22)
- [x] **Responsive layout** — Portrait mode (< 700px) vertical stack with chat anchored center at 46%; wide mode unchanged (commit `c1a1508`, 2026-02-22)

---

## Remaining Backlog

### Test Coverage Gaps (~8 SP)

| ID | SP | Title | Notes |
|----|-----|-------|-------|
| TC-01 | 2 | Add `test_journal.py` — read/write against test repo | Journal service writes `.devcoach/journal.md`; needs a test repo fixture |
| TC-02 | 3 | Add `test_coaching.py` — Peter/Ransom detection logic | Verify profile escalation thresholds from `coaching_service.py` |
| TC-03 | 3 | Add `test_puzzle.py` — puzzle generation + submission flow | Cover 4 puzzle types, badge award, `within_limit` generated column |

### Backend Gaps (~5 SP)

| ID | SP | Title | Notes |
|----|-----|-------|-------|
| BE-01 | 2 | Alembic upgrade on Render | Run `alembic upgrade head` via Render shell; one-time manual step |
| BE-02 | 2 | End-to-end smoke test | Real GitHub repo → queue fetch → work block → Haiku chat → journal write |
| BE-03 | 1 | CORS: confirm `vscode-webview://*` covers all VS Code origins in production | May need wildcard pattern adjustment |

### Extension / Publishing (~5 SP)

| ID | SP | Title | Notes |
|----|-----|-------|-------|
| EX-01 | 3 | Publish `.vsix` to VS Code Marketplace | Requires publisher account + extension manifest review |
| EX-02 | 2 | GitHub PAT scope validation at config time | Warn if PAT lacks `repo`, `read:user`, or `gist` scopes needed for badges/Gist |

### Web App Polish (~4 SP)

| ID | SP | Title | Notes |
|----|-----|-------|-------|
| WA-01 | 2 | Multi-session support for multi-repo | Currently one session per user per day; second repo can't start a new session; consider `repo` column on sessions |
| WA-02 | 1 | Web: settings gear opens full ConfigScreen modal instead of new route | Currently shows full screen; modal UX is better |
| WA-03 | 1 | Web: dark/light theme toggle | Add a system-preference `prefers-color-scheme` listener to swap CSS vars |

---

## Future Phases (Post-MVP)

| Phase | Focus | Estimated Effort |
|-------|-------|-----------------|
| Phase A | Multi-session-per-repo on same day (WA-01) + PAT scope validation (EX-02) | 1 week |
| Phase B | VS Code Marketplace publish + onboarding wizard | 1 week |
| Phase C | Team mode — coaching profile aggregation across multiple devs on same repo | 3 weeks |
| Phase D | Slack/GitHub Discussions integration for annotation reminders | 2 weeks |

---

## Sprint Plan (Next Session)

### Sprint A: Test Coverage + Smoke Test (~8 SP)
| Task | SP |
|------|----|
| TC-01: Add test_journal.py | 2 |
| TC-02: Add test_coaching.py | 3 |
| TC-03: Add test_puzzle.py | 3 |

### Sprint B: Deploy Verification (~5 SP)
| Task | SP |
|------|----|
| BE-01: Run alembic upgrade head on Render | 2 |
| BE-02: End-to-end smoke test against real repo | 2 |
| BE-03: Verify CORS for VS Code production origins | 1 |

---

## Version History

| Version | Date | Milestone |
|---------|------|-----------|
| 0.1.0 | 2026-02-21 | All 5 build phases complete, .vsix packaged |
| **0.2.0** | **2026-02-22** | **Standalone web app, split-panel dashboard, multi-repo, responsive** |
| **1.0.0** | **TBD** | **VS Code Marketplace + all tests passing + smoke test verified** |

---

## Key Notes

> **Session per day constraint** — PostgreSQL UNIQUE(user_id, date) means only one session per calendar day. If multi-repo needs separate sessions, add a `repo` column to the unique constraint (WA-01). This is intentional for coaching continuity but may need relaxing for power users.

> **Credential auto-seed** — `VITE_PREFILL_*` env vars are baked into the Vite build at build time. Rotating the PAT or Anthropic key requires a Render redeploy. The values are set as Render secrets (`sync: false`) so they're never in source code.

> **react-resizable-panels v4** — v4 API uses `Group` (not `PanelGroup`), `Separator` (not `PanelResizeHandle`), and `orientation` prop (not `direction`). The `DashboardLayout.tsx` imports use `{ Panel, Group as PanelGroup, Separator as PanelResizeHandle }` aliasing for readability.

---

## Quick Reference

| Resource | Location |
|----------|----------|
| This roadmap | `docs/ROADMAP-2026-02-22.md` |
| Architecture | `docs/ARCHITECTURE.md` |
| Coaching model | `docs/COACHING_MODEL.md` |
| Backend tests | `cd backend && source .venv/bin/activate && python -m pytest tests/ -q` |
| Extension build | `cd extension && npm run build` |
| Web dev server | `cd web && npm run dev` |
| Live web app | https://devcoach-web.onrender.com |
| Backend API | https://devcoach-api.onrender.com |

---

*Single source of truth as of 2026-02-22. All 5 build phases shipped; standalone web app live on Render with split-panel dashboard and multi-repo support. Next priority: test coverage (TC-01 through TC-03) and production smoke test.*
